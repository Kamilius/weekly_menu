%html{:'ng-app' => 'weeklyMenuApp'}
  %head
    %meta{:charset => 'UTF-8'}
    %meta{:name => 'viewport', :content => 'width=device-width, initial-scale=1'}
    %title Меню на тиждень
    %link{:href => 'styles/style.css', :rel => 'stylesheet'}
  %body
    %header
      .container
        .logo
          %img{:src => 'images/chef_hat_logo.png'}
        %h2.title Меню на тиждень
    %nav
      .container
        %ul
          %li{:'ng-class' => 'getClass("/home")'}
            %a{:href => '#/home'} Перелік рецептів
          %li{:'ng-class' => 'getClass("/recipes")'}
            %a{:href => '#/recipes'} Додати рецепт
          %li{:'ng-class' => 'getClass("/ingredients")'}
            %a{:href => '#/ingredients'} Інгредієнти
    
    .message{:'ng-class' => '{ error: statusMessage.type == "error", success: statusMessage.type == "success"}'}
      {{ statusMessage.text }}
    %div.page-body{:'ng-view' => ''}

    %script{:type => 'text/ng-template', :id => 'calendar.html'}
      .container.margin-top-25
        %section.row.calendar-pagination
          .col-xs-1.pull-right.pagination-container
            %button{:'ng-click' => 'prevWeek()', :'ng-disabled' => 'calendarService.currentWeek === 1'}
              %span.glyphicon.glyphicon-backward
            .current-week {{ "Тиждень №" + calendarService.currentWeek() }}
            %button{:'ng-click' => 'nextWeek()'}
              %span.glyphicon.glyphicon-forward
        %section.row.calendar
          .calendar-days
            .col-xs-1.day-header Понеділок
            .col-xs-1.day-header Вівторок
            .col-xs-1.day-header Середа
            .col-xs-1.day-header Четвер
            .col-xs-1.day-header П'ятниця
            .col-xs-1.day-header Субота
            .col-xs-1.day-header Неділя
          .calendar-recipes
            .day.col-xs-1{:'ng-repeat' => 'day in weeklyMenu', :'ng-class' => '{ {{day.name}}: true, today: day.today() }', :ondragover => "event.preventDefault()", :'drag-enter-leave-animation' => ''}
              .date {{ day.date | date }}
              .recipe{:'ng-repeat' => 'recipe in day.recipes track by $index'}
                %recipecontrols
                %h5.recipe-title
                  {{ recipe.name }}
                %ul.recipe-ingredients
                  %li{:'ng-repeat' => 'ing in recipe.ingredients'}
                    {{ ing.parent.name }}

    %script{:type => 'text/ng-template', :id => 'recipesContainer.html'}
      .container.recipes-container
        .recipe{:'ng-repeat' => 'recipe in recipes', :draggable => 'true', :'data-id' => '{{ recipe.id }}'}
          %recipecontrols
          {{ recipe.name }}

    %script{:type => 'text/ng-template', :id => 'home.html'}
      %calendar
      %recipescontainer

    %script{:type => 'text/ng-template', :id => 'recipesCRUD.html'}
      .container.margin-top-25
        %section.row
          %form.recipe-form.col-md-12{:role => "form", :name => "recipeForm"}
            .form-group
              %label{:for => "recipe-title"} Назва рецепту
              %input.form-control.material-shadow{:type => "text", :'ng-model' => 'recipe.name', :required => '', :oninvalid => 'setCustomValidity("Це поле не може бути пустим")'}
            .form-group.recipe-ingredients
              %label Інгридієнти
              .dropdown-filter.row
                .col-xs-8
                  %input.form-control.material-shadow.no-right-border-radius{:type => "text", :'ng-model' => 'ingModel.name', :placeholder => 'почніть вводити назву інгридієнта'}
                  %ul.available-ingredients.material-shadow
                    %li.ingredient-item{:'ng-repeat' => 'item in ingredients | filter:ingModel.name', :'ng-click' => 'chooseIngredient(item)'}
                      {{ item.name }}
                .col-xs-2
                  %input.form-control.material-shadow.no-border-radius{:type => "text", :'ng-model' => 'ingModel.amount', :placeholder => 'к-сть'}
                .col-xs-1
                  %select.form-control.material-shadow.no-border-radius{:'ng-model' => 'ingModel.units'}
                    %option{:value => 'шт.'} шт.
                    %option{:value => 'кг'} кг
                    %option{:value => 'г'} г
                    %option{:value => 'л'} л
                    %option{:value => 'мл'} мл
                    %option{:value => 'ч.л.'} ч.л.
                    %option{:value => 'стол.л.'} стол.л.
                .col-xs-1
                  %button.btn.btn-default.material-shadow.no-left-border-radius{:'ng-click' => 'addIngredient()'} Додати
              .ingredient.form-control.material-shadow{:'ng-repeat' => 'ingredient in recipe.ingredients'}
                {{ ingredient.parent.name + ' ' + ingredient.amount + ingredient.units }}
                .remove-ingredient{:'ng-click' => 'removeIngredient(recipe.ingredients[$index])'} &#57364;

            %a.btn.btn-default.pull-right.material-shadow{:href => '#/home'}
              Повернутись на головну
            %button.btn.btn-success.pull-right.material-shadow{:'ng-click' => 'saveRecipe()'}
              Зберегти рецепт

    %script{:type => 'text/ng-template', :id => 'recipeControls.html'}
      .recipe-controls
        %span.glyphicon.glyphicon-chevron-left
        %a.glyphicon.glyphicon-pencil{:title => 'Редагувати', :href => '#/recipes/{{ recipe.id }}'}
        %span.glyphicon.glyphicon-remove{:title => 'Видалити', :'ng-click' => 'removeRecipe(recipe, day)'}

    %script{:type => 'text/ng-template', :id => 'ingredients.html'}
      .container.margin-top-25.ingredients-container
        .row.ing-input-wrapper
          %input.form-control.col-xs-3.ing-name.material-shadow{:type => 'text', :'ng-model' => 'ingredient.name', :placeholder => 'введіть назву інгридієнта'}
          %button.btn.btn-default.ing-add.material-shadow{:'ng-click' => 'saveIngredient()'} Зберегти
        .row
          .recipe{:'ng-repeat' => 'item in ingredients', :'ng-click' => 'editIngredient(item)', :'ng-class' => 'ingredientActive(item)', :title => 'клікніть аби змінити'}
            {{ item.name }}
            %span.glyphicon.glyphicon-remove{:title => 'Видалити', :'ng-click' => 'removeIngredient(item)'}


    %script{:src => 'scripts/main.min.js'}